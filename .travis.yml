language: cpp

jobs:
  include:
    - os: linux
      arch: arm64
    - os: linux
      arch: amd64
    - os: windows
      arch: amd64
    - os: osx
      arch: amd64

branches:
  only:
    - master
      
script:
    - if [[ ${TRAVIS_CPU_ARCH} == "arm64"]]; then 
        copy ./platforms/aarch64/libDynamsoftBarcodeReader.so /usr/lib/;
      fi
    - mkdir -p build
    - cd build
    - if [[ ${TRAVIS_OS_NAME} == "windows" ]]; then
        cmake -DCMAKE_GENERATOR_PLATFORM=x64 ..;
      else
        cmake ..;
      fi
    - cmake --build . --config release